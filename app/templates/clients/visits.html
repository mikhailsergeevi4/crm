{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}

	<h1>{{ person.name }}</h1>

  <!-- Modal -->
  	<div class="modal fade" id="ModalCenter" tabindex="-1" role="dialog" aria-labelledby="ModalCenterTitle" aria-hidden="true">
  		<div class="modal-dialog modal-dialog-centered" role="document">
  			<div class="modal-content">
  				<div class="modal-header">
  					<h5 class="modal-title" id="ModalLongTitle">Новый Визит</h5>
  				</div>
  				<div class="modal-body" id="modal-body">
  					{% if form %}
  						{{ wtf.quick_form(form) }}
  					{% endif %}
  				</div>
  				<div class="modal-footer">
  					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
  						<span aria-hidden="true">&times;</span>
  					</button>
  				</div>
  			</div>
  		</div>
  	</div>



    <div class="row">
      <div class="col-md-8">
        <h2>Визиты:</h2>
      </div>

      <div class="col-md-4">
  		   <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ModalCenter">
    		Добавить визит
  		 </button>
  	  </div>
    </div>

    <div class = 'row'>
      {% for i in visits %}
      <div class = 'row'>
        <div class = 'col-md-6'>
          {{moment(i.date).format('LL')}}
        </div>
        <div class = 'col-md-6'>
          <button class="btn btn-default" data-href="{{ url_for('clients.deleteVisit', person_id = person.id,   clinic_id=clinic_id, region_name=region_name, visit_id=i.id) }}" data-toggle="modal" data-target="#confirm-delete">
            Удалить
          </button>

          <div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">

                          <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                              <h4 class="modal-title" id="myModalLabel">Подтверждение удаления</h4>
                          </div>

                          <div class="modal-body">
                              <p>Вы уверены что хотите удалить визит?</p>
                          </div>

                          <div class="modal-footer">
                              <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                              <a class="btn btn-danger btn-ok">Удалить</a>
                          </div>
                      </div>
                  </div>
              </div>

        </div>
        <div class="row">
          <div class = 'col-md-12'>
          Дата следующего визита: {{moment(i.date_of_next_visit).format('LL')}}
          </div>
          <div class = 'col-md-12'>
          Договоренности: {{i.arrangements}}
        </div>
      </div>
      </div>
      {% endfor %}
      <div>
        <a href="{{ url_for('clients.showPersons', region_name=region_name, clinic_id=clinic_id) }}">
        <p>
          Назад
        </p>
      </a>
      </div>
    </div>

{% endblock %}
